<!-- NavigationBar loading progress (fixed top) -->
<div class="fixed inset-x-0 top-0 z-50 h-1">
  @if (loading()) {
  <p-progressBar mode="indeterminate" [style]="{ height: '4px' }" />
  }
</div>

<div
  class="relative flex h-screen flex-col items-start overflow-hidden lg:flex-row bg-ui-bg-subtle"
>
  <div>
    <p-dialog
      [visible]="sidebar.mobileOpen()"
      (visibleChange)="sidebar.setMobile($event)"
      [modal]="true"
      [dismissableMask]="true"
      [draggable]="false"
      [resizable]="false"
      [closable]="false"
      [style]="{ width: '304px', maxWidth: '304px', height: '100vh' }"
      [contentStyle]="{ padding: '0' }"
      position="left"
    >
      <ng-template pTemplate="header">
        <div class="w-full p-3">
          <button
            pButton
            type="button"
            class="p-button-text p-button-sm"
            icon="pi pi-times"
            [attr.aria-label]="'layout.shell.closeNavigation' | transloco"
            (click)="closeMobile()"
          ></button>
          <span class="sr-only">{{ 'layout.shell.navigation' | transloco }}</span>
        </div>
      </ng-template>

      @if (sidebarTemplate) {
      <ng-container *ngTemplateOutlet="sidebarTemplate"></ng-container>
      }
    </p-dialog>

    @if (sidebar.desktopOpen()) {
    <div class="hidden h-screen w-[220px] border-e lg:flex">
      @if (sidebarTemplate) {
      <ng-container *ngTemplateOutlet="sidebarTemplate"></ng-container>
      }
    </div>
    }
  </div>

  <div class="flex h-screen w-full flex-col">
    <div class="grid w-full grid-cols-2 border-b p-2">
      <div class="flex items-center gap-x-1.5">
        <div>
          <button
            pButton
            type="button"
            class="hidden p-button-text p-button-sm lg:flex"
            icon="pi pi-bars"
            size="small"
            [attr.aria-label]="'layout.shell.toggleNavigation' | transloco"
            (click)="toggleDesktop()"
          ></button>

          <button
            pButton
            type="button"
            class="flex p-button-text p-button-sm lg:hidden"
            icon="pi pi-bars"
            [attr.aria-label]="'layout.shell.openNavigation' | transloco"
            size="small"
            (click)="toggleMobile()"
          ></button>
        </div>

        <div *transloco="let t" class="flex flex-col leading-tight">
          <span class="text-sm font-semibold text-ui-fg-base">
            {{ t('app.title') }}
          </span>
          <span class="text-xs text-ui-fg-muted">
            {{ t('demo.hello', { name: 'Dylan' }) }}
          </span>
        </div>

        <!-- <div class="px-3">
          <button
            type="button"
            class="bg-ui-bg-subtle text-ui-fg-subtle flex w-full items-center gap-x-2.5 rounded-md px-2 py-1 outline-none hover:bg-ui-bg-subtle-hover focus-visible:shadow-borders-focus"
          >
            <i class="pi pi-search"></i>
            <div class="flex-1 text-start">
              <span class="text-sm font-semibold">Search</span>
            </div>
            <span class="text-sm text-ui-fg-muted">âŒ˜K</span>
          </button>
        </div> -->

        <!-- <ol class="text-ui-fg-muted txt-compact-small-plus flex select-none items-center">
          <ng-container *ngFor="let c of breadcrumbs.crumbs(); let i = index">
            <li class="flex items-center">
              @if (i < breadcrumbs.crumbs().length - 1) {
                <a class="transition-fg hover:text-ui-fg-subtle" [routerLink]="c.path">
                  {{ c.label }}
                </a>
              } @else {
                <div>
                  @if (breadcrumbs.crumbs().length > 1) {
                    <span class="block lg:hidden"> ... </span>
                  }
                  <span
                    class="lg:block"
                    [class.hidden]="breadcrumbs.crumbs().length > 1"
                  >
                    {{ c.label }}
                  </span>
                </div>
              }

              @if (i < breadcrumbs.crumbs().length - 1) {
                <span class="mx-2">
                  <i class="pi pi-angle-right rtl:rotate-180"></i>
                </span>
              }
            </li>
          </ng-container>
        </ol> -->
      </div>

      <div class="flex items-center justify-end gap-x-3">
        <app-language-switcher />
        <app-notifications />
      </div>
    </div>

    <main
      class="flex min-h-0 flex-1 w-full flex-col items-center transition-opacity delay-200 duration-200"
      [class.opacity-25]="loading()"
    >
      <div class="flex min-h-0 w-full flex-1 flex-col">
        <router-outlet />
      </div>
    </main>
  </div>
</div>
