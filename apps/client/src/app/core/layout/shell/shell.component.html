<!-- NavigationBar loading progress (fixed top) -->
<div class="fixed inset-x-0 top-0 z-50 h-1">
  @if (loading()) {
    <fe-progress-bar className="h-1" />
  }
</div>

<div
  class="relative flex h-screen flex-col items-start overflow-hidden lg:flex-row bg-ui-bg-subtle"
>
  <div>
    <flex-dialog
      [open]="sidebar.mobileOpen()"
      (openChange)="sidebar.setMobile($event)"
      [modal]="true"
      mode="sheet-left"
      contentClass="h-full w-full max-w-[304px] rounded-none border-r border-ui-border-base bg-ui-bg-base shadow-lg"
    >
      <div class="w-full p-3 border-b border-ui-border-base">
        <button
          type="button"
          class="inline-flex h-8 w-8 items-center justify-center rounded-md text-ui-fg-muted transition-fg hover:bg-ui-bg-subtle-hover"
          [attr.aria-label]="'layout.shell.closeNavigation' | transloco"
          (click)="closeMobile()"
        >
          <i-lucide [img]="X" class="h-4 w-4"></i-lucide>
        </button>
        <span class="sr-only">{{ 'layout.shell.navigation' | transloco }}</span>
      </div>

      @if (sidebarTemplate) {
        <ng-container *ngTemplateOutlet="sidebarTemplate"></ng-container>
      }
    </flex-dialog>

    @if (sidebar.desktopOpen()) {
      <div class="hidden h-screen w-[220px] border-e lg:flex">
        @if (sidebarTemplate) {
          <ng-container *ngTemplateOutlet="sidebarTemplate"></ng-container>
        }
      </div>
    }
  </div>

  <div class="flex h-screen w-full flex-col">
    <div class="grid w-full grid-cols-2 border-b p-2">
      <div class="flex items-center gap-x-1.5">
        <div>
          <button
            type="button"
            class="hidden h-8 w-8 items-center justify-center rounded-md text-ui-fg-muted transition-fg hover:bg-ui-bg-subtle-hover lg:flex"
            [attr.aria-label]="'layout.shell.toggleNavigation' | transloco"
            (click)="toggleDesktop()"
          >
            <i-lucide [img]="Menu" class="h-4 w-4"></i-lucide>
          </button>

          <button
            type="button"
            class="flex h-8 w-8 items-center justify-center rounded-md text-ui-fg-muted transition-fg hover:bg-ui-bg-subtle-hover lg:hidden"
            [attr.aria-label]="'layout.shell.openNavigation' | transloco"
            (click)="toggleMobile()"
          >
            <i-lucide [img]="Menu" class="h-4 w-4"></i-lucide>
          </button>
        </div>

        <div *transloco="let t" class="flex flex-col leading-tight">
          <span class="text-sm font-semibold text-ui-fg-base">
            {{ t('app.title') }}
          </span>
          <span class="text-xs text-ui-fg-muted">
            {{ t('demo.hello', { name: 'Dylan' }) }}
          </span>
        </div>

        <!-- <div class="px-3">
          <button
            type="button"
            class="bg-ui-bg-subtle text-ui-fg-subtle flex w-full items-center gap-x-2.5 rounded-md px-2 py-1 outline-none hover:bg-ui-bg-subtle-hover focus-visible:shadow-borders-focus"
          >
            <div class="flex-1 text-start">
              <span class="text-sm font-semibold">Search</span>
            </div>
            <span class="text-sm text-ui-fg-muted">⌘K</span>
          </button>
        </div> -->

        <!-- <ol class="text-ui-fg-muted txt-compact-small-plus flex select-none items-center">
          <ng-container *ngFor="let c of breadcrumbs.crumbs(); let i = index">
            <li class="flex items-center">
              @if (i < breadcrumbs.crumbs().length - 1) {
                <a class="transition-fg hover:text-ui-fg-subtle" [routerLink]="c.path">
                  {{ c.label }}
                </a>
              } @else {
                <div>
                  @if (breadcrumbs.crumbs().length > 1) {
                    <span class="block lg:hidden"> ... </span>
                  }
                  <span
                    class="lg:block"
                    [class.hidden]="breadcrumbs.crumbs().length > 1"
                  >
                    {{ c.label }}
                  </span>
                </div>
              }

              @if (i < breadcrumbs.crumbs().length - 1) {
                <span class="mx-2">
                  <span class="text-ui-fg-muted">›</span>
                </span>
              }
            </li>
          </ng-container>
        </ol> -->
      </div>

      <div class="flex items-center justify-end gap-x-3">
        <app-language-switcher />
        <app-notifications />
      </div>
    </div>

    <main
      class="flex min-h-0 flex-1 w-full flex-col items-center transition-opacity delay-200 duration-200 overflow-y-auto"
      [class.opacity-25]="loading()"
    >
      <div class="flex w-full flex-col">
        <router-outlet />
      </div>
    </main>
  </div>
</div>
