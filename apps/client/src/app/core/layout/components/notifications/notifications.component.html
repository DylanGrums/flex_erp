<div class="relative">
  <button
    type="button"
    class="inline-flex h-8 w-8 items-center justify-center rounded-md text-ui-fg-muted transition-fg hover:bg-ui-bg-subtle-hover"
    [attr.aria-label]="'layout.notifications.ariaLabel' | transloco"
    (click)="toggle()"
  >
    <i-lucide [img]="Bell" class="h-4 w-4"></i-lucide>
  </button>

  <span
    *ngIf="hasUnread()"
    class="absolute right-2 top-1 h-2 w-2 rounded bg-ui-bg-interactive"
  ></span>
</div>

<flex-dialog
  [open]="open()"
  (openChange)="setOpen($event)"
  [modal]="true"
  mode="sheet-right"
  contentClass="h-full w-full max-w-[420px] rounded-none border-l border-ui-border-base bg-ui-bg-base shadow-lg"
>
  <div class="flex items-center justify-between px-6 py-4">
    <div class="text-base font-semibold">{{ 'layout.notifications.title' | transloco }}</div>
  </div>

  <fe-divider />

  <div *ngIf="items().length === 0" class="flex h-full flex-col items-center justify-center px-6 py-8">
    <i-lucide [img]="BellOff" class="h-6 w-6 text-ui-fg-muted"></i-lucide>
    <div class="mt-3 text-sm font-semibold">{{ 'layout.notifications.allCaughtUp' | transloco }}</div>
    <div class="mt-1 max-w-[294px] text-center text-sm text-ui-fg-muted">
      {{ 'layout.notifications.empty' | transloco }}
    </div>
  </div>

  <div *ngIf="items().length > 0" class="-mx-4">
    <div *ngFor="let n of items()" class="relative flex items-start gap-3 border-b px-6 py-4">
      <div class="text-ui-fg-muted flex size-5 items-center justify-center">
        <i-lucide [img]="Info" class="h-4 w-4"></i-lucide>
      </div>

      <div class="flex w-full flex-col gap-y-2">
        <div class="flex items-center justify-between">
          <div class="text-sm font-semibold">{{ n.title }}</div>

          <div class="flex items-center gap-2">
            <span class="text-sm" [class.text-ui-fg-base]="isUnread(n)" [class.text-ui-fg-subtle]="!isUnread(n)">
              {{ n.createdAt | date: 'short' }}
            </span>

            <span *ngIf="isUnread(n)" class="bg-ui-bg-interactive h-2 w-2 rounded" role="status"></span>
          </div>
        </div>

        <div *ngIf="n.description" class="text-sm text-ui-fg-subtle whitespace-pre-line">{{ n.description }}</div>
      </div>
    </div>
  </div>
</flex-dialog>
