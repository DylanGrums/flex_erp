<header
  class="h-14 w-full justify-between bg-ui-bg-base border-b border-ui-border-base flex items-center px-4 gap-4 shrink-0"
>
  <div class="flex items-center gap-3 min-w-[400px]">
    <div
      class="w-8 h-8 rounded-lg bg-ui-bg-interactive flex items-center justify-center"
    >
      <i-lucide [img]="Palette" class="h-4 w-4 text-ui-fg-on-color"></i-lucide>
    </div>

    @if (isEditingName) {
    <cms-input
      [value]="nameValue"
      (valueChange)="nameValue = $event"
      (blurred)="submitName()"
      (enterPressed)="submitName()"
      className="h-8 w-40 text-sm font-medium"
    ></cms-input>
    } @else {
    <button
      type="button"
      (click)="startEditing()"
      class="text-sm font-medium text-ui-fg-base hover:text-ui-fg-interactive transition-colors"
    >
      {{ storeName }}
    </button>
    }
  </div>

  <div class="flex-1 flex justify-center">
    <button
      type="button"
      [flexDropdownMenuTrigger]="pageMenu"
      class="inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors border border-ui-border-base bg-ui-bg-base hover:bg-ui-bg-subtle-hover h-8 px-3 gap-2"
    >
      {{ currentPageLabel | transloco }}
      <i-lucide [img]="ChevronDown" class="h-3 w-3 text-ui-fg-muted"></i-lucide>
    </button>

    <ng-template #pageMenu>
      <div
        flexDropdownMenuContent
        class="rounded-md border border-ui-border-base bg-ui-bg-base p-1 shadow"
      >
        @for (page of pages; track page.value) {
        <button
          type="button"
          flexDropdownMenuItem
          (click)="currentPageChange.emit(page.value)"
          class="flex w-full items-center gap-2 rounded px-2 py-1.5 text-sm hover:bg-ui-bg-subtle-hover"
        >
          {{ page.label | transloco }}
          @if (currentPage === page.value) {
          <i-lucide [img]="Check" class="ms-auto h-3 w-3 text-ui-fg-interactive"></i-lucide>
          }
        </button>
        }
      </div>
    </ng-template>
  </div>

  <div class="flex items-center gap-2 min-w-[400px] justify-end">
    <div class="flex items-center bg-ui-bg-subtle rounded-lg p-1 gap-0.5">
      @for (device of devices; track device.value) {
      <button
        type="button"
        [flexTooltipTrigger]="deviceTooltip"
        (click)="viewportModeChange.emit(device.value)"
        class="p-1.5 rounded-md transition-colors cursor-pointer"
        [class.bg-ui-bg-base]="viewportMode === device.value"
        [class.text-ui-fg-base]="viewportMode === device.value"
        [class.text-ui-fg-muted]="viewportMode !== device.value"
        [class.shadow-sm]="viewportMode === device.value"
        [class.hover:bg-ui-bg-subtle-hover]="viewportMode !== device.value"
        [class.border-none]="viewportMode !== device.value"
      >
        <i-lucide [img]="device.icon" class="h-4 w-4"></i-lucide>
      </button>
      <ng-template #deviceTooltip>
        <div
          flexTooltip
          class="rounded-md bg-ui-bg-base border border-ui-border-base px-2 py-1 text-xs shadow"
        >
          {{ device.label | transloco }}
        </div>
      </ng-template>
      }
    </div>

    <div class="w-px h-6 bg-ui-border-base mx-1"></div>

    <button
      type="button"
      [flexTooltipTrigger]="undoTooltip"
      [disabled]="!canUndo"
      (click)="undo.emit()"
      class="inline-flex h-8 w-8 items-center justify-center text-sm font-medium border-none transition-colors hover:bg-ui-bg-subtle-hover cursor-pointer"
    >
      <i-lucide
        [img]="Undo2"
        class="w-4 h-4 text-muted-foreground shrink-0 hover:text-ui-fg-base'"
      ></i-lucide>
    </button>
    <ng-template #undoTooltip>
      <div flexTooltip class="bg-ui-bg-base  px-2 py-1 text-xs shadow">
        {{ 'cms.editor.actions.undo' | transloco }}
      </div>
    </ng-template>

    <button
      type="button"
      [flexTooltipTrigger]="redoTooltip"
      [disabled]="!canRedo"
      (click)="redo.emit()"
      class="inline-flex h-8 w-8 items-center justify-center text-sm font-medium border-none transition-colors hover:bg-ui-bg-subtle-hover cursor-pointer"
    >
      <i-lucide
        [img]="Redo2"
        class="w-4 h-4 text-muted-foreground shrink-0 hover:text-ui-fg-base'"
      ></i-lucide>
    </button>
    <ng-template #redoTooltip>
      <div flexTooltip class="bg-ui-bg-base  px-2 py-1 text-xs shadow">
        {{ 'cms.editor.actions.redo' | transloco }}
      </div>
    </ng-template>

    <div class="w-px h-6 bg-ui-border-base mx-1"></div>

    <cms-button
      variant="outline"
      size="sm"
      (click)="save.emit()"
      className="gap-1.5"
    >
      <i-lucide [img]="Save" class="h-4 w-4"></i-lucide>
      {{ 'cms.editor.actions.save' | transloco }}
    </cms-button>

    <cms-button size="sm" (click)="publish.emit()" className="gap-1.5">
      <i-lucide [img]="Send" class="h-4 w-4"></i-lucide>
      {{ 'cms.editor.actions.publish' | transloco }}
    </cms-button>
  </div>
</header>
