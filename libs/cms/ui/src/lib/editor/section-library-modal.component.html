<cms-dialog
  [open]="open"
  (openChange)="requestClose.emit()"
  contentClass="w-full max-w-3xl max-h-[80vh] p-0 gap-0 overflow-hidden rounded-lg border border-ui-border-base bg-ui-bg-base shadow-lg"
>
  <div class="px-6 py-4 border-b border-ui-border-base">
    <h2 class="text-lg font-semibold text-ui-fg-base">Add Section</h2>
  </div>

  <div class="px-6 py-4 border-b border-ui-border-base space-y-4">
    <div class="relative">
      <i class="pi pi-search absolute left-3 top-1/2 -translate-y-1/2 text-ui-fg-muted text-xs"></i>
      <cms-input
        placeholder="Search sections..."
        [value]="search"
        (valueChange)="search = $event"
        className="pl-9"
      ></cms-input>
    </div>

    <cms-tabs [tabs]="categories" [value]="activeCategory" (valueChange)="activeCategory = $event"></cms-tabs>
  </div>

  <cms-scroll-area className="flex-1 max-h-[400px]">
    <div class="p-6 grid grid-cols-2 md:grid-cols-3 gap-4">
      @if (filteredSections().length === 0) {
        <div class="col-span-full text-center py-12 text-ui-fg-muted">
          <p class="font-medium">No sections found</p>
          <p class="text-sm mt-1">Try adjusting your search or category</p>
        </div>
      } @else {
        @for (def of filteredSections(); track def.type) {
          <button
            type="button"
            (click)="handleAdd(def)"
            class="group p-4 rounded-xl border border-ui-border-base bg-ui-bg-base hover:border-ui-border-interactive hover:shadow-md transition-all text-left"
          >
            <div class="w-10 h-10 rounded-lg bg-ui-bg-subtle flex items-center justify-center mb-3 group-hover:bg-ui-bg-subtle-hover transition-colors">
              <i [class]="iconClass(def.icon) + ' text-ui-fg-base'"></i>
            </div>
            <h3 class="font-medium text-sm mb-1">{{ def.name }}</h3>
            <p class="text-xs text-ui-fg-muted line-clamp-2">{{ def.description }}</p>
          </button>
        }
      }
    </div>
  </cms-scroll-area>
</cms-dialog>
